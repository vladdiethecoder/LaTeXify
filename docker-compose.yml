services:
  latexify:
    build: .
    image: latexify:latest
    volumes:
      - .:/app
      - ~/.cache/huggingface:/root/.cache/huggingface
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]
    environment:
      - HF_HOME=/root/.cache/huggingface
    command: python3 run_latexify.py
    ipc: host # Necessary for PyTorch/vLLM shared memory